{% extends 'base.html' %}

{% block title %}–ó–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ –ø–ª–∞–Ω–∏{% endblock %}
{% block header %}‚úÖ –ó–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ –ø–ª–∞–Ω–∏{% endblock %}

{% block content %}
<div class="d-flex justify-content-between mb-3">
  <a href="{{ url_for('plans.hub') }}" class="btn btn-outline-secondary">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</a>
  <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
  <a href="{{ url_for('approved_plans.export_pdf', company_id=request.args.get('company_id'), culture_id=request.args.get('culture_id')) }}"
   class="btn btn-outline-primary">
  üßæ –ï–∫—Å–ø–æ—Ä—Ç —É PDF
</a>
</div>

<!-- üîç –§–æ—Ä–º–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó -->
<form method="GET" class="row g-2 mb-4">
  <div class="col-md-3">
    <select name="company_id" class="form-select">
      <option value="">üè¢ –í—Å—ñ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞</option>
      {% for c in companies %}
        <option value="{{ c.id }}" {% if selected_company == c.id %}selected{% endif %}>
          {{ c.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-3">
    <select name="culture_id" class="form-select">
      <option value="">üå± –í—Å—ñ –∫—É–ª—å—Ç—É—Ä–∏</option>
      {% for c in cultures %}
        <option value="{{ c.id }}" {% if selected_culture == c.id %}selected{% endif %}>
          {{ c.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-3 d-grid">
    <button type="submit" class="btn btn-outline-success">üîç –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>
  </div>
</form>

<!-- üìã –¢–∞–±–ª–∏—Ü—è –∑–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –ø–ª–∞–Ω—ñ–≤ -->
<table class="table table-hover table-bordered text-center align-middle">
  <thead class="table-success">
    <tr>
      <th>–ü–æ–ª–µ</th>
      <th>–ü–ª–æ—â–∞</th>
      <th>–ö—É–ª—å—Ç—É—Ä–∞</th>
      <th>–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è</th>
      <th>–î—ñ—ó</th>
    </tr>
  </thead>
  <tbody>
    {% for plan in plans %}
    <tr>
      <td>{{ plan.field.name }}</td>
      <td>{{ plan.field.area }}</td>
      <td>{{ plan.field.culture.name if plan.field.culture else '‚Äî' }}</td>
      <td>{{ plan.created_at.strftime('%Y-%m-%d') if plan.created_at else '' }}</td>
      <td>
        <a href="{{ url_for('approved_plans.view_plan', plan_id=plan.id) }}"
           class="btn btn-outline-primary btn-sm">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥</a>
        <a href="{{ url_for('approved_plans.unlock_plan', plan_id=plan.id) }}"
           class="btn btn-outline-warning btn-sm">üîì –î–æ–∑–≤–æ–ª–∏—Ç–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è</a>
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="5" class="text-muted">–ù–µ–º–∞—î –∑–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –ø–ª–∞–Ω—ñ–≤ –∑–∞ –≤–∏–±—Ä–∞–Ω–∏–º–∏ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
