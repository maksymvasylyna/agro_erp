{% extends 'reference/_index_base.html' %}

{% block title %}–ü—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞{% endblock %}
{% block header %}üè¢ –ü—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞{% endblock %}

{% block before_table %}
  {# Flash-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–ø–µ—Ä–µ–Ω–µ—Å–∏ –≤ _index_base.html, —è–∫—â–æ —Ö–æ—á–µ—à –º–∞—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ) #}
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mb-3">
        {% for category, message in messages %}
          <div class="alert alert-{{ 'warning' if category in ['warning', 'error'] else category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}
{% endblock %}

{% block filter_form %}
<form method="get" class="d-flex flex-wrap gap-3 mb-3">
  {{ form.hidden_tag() }}

  <div>
    {{ form.name.label(class="form-label") }}
    {{ form.name(class="form-select" + (" is-invalid" if form.name.errors else "")) }}
    {% for err in form.name.errors %}
      <div class="invalid-feedback d-block">{{ err }}</div>
    {% endfor %}
  </div>

  <div>
    {{ form.cluster.label(class="form-label") }}
    {{ form.cluster(class="form-select" + (" is-invalid" if form.cluster.errors else "")) }}
    {% for err in form.cluster.errors %}
      <div class="invalid-feedback d-block">{{ err }}</div>
    {% endfor %}
  </div>

  <div class="align-self-end d-flex gap-2">
    {{ form.submit(class="btn btn-primary") }}
    <a href="{{ url_for('companies.index') }}" class="btn btn-outline-secondary">Reset</a>
  </div>
</form>
{% endblock %}

{% block table_headers %}
  <th>ID</th>
  <th>–ù–∞–∑–≤–∞</th>
  <th>–ö–ª–∞—Å—Ç–µ—Ä</th>
  <th class="text-center">–î—ñ—ó</th>
{% endblock %}

{% block table_rows %}
  {% for id, name, cluster_name, edit_url, delete_url in items %}
  <tr>
    <td>{{ id }}</td>
    <td>{{ name }}</td>
    <td>{{ cluster_name }}</td>
    <td class="text-center">
      <a href="{{ edit_url }}" class="btn btn-sm btn-primary" title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">‚úèÔ∏è</a>
      <form action="{{ delete_url }}" method="post" style="display:inline-block;" onsubmit="return confirm('–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è?')">
        {# –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Flask-WTF CSRFProtect ‚Äî –¥–æ–¥–∞–π —Ç–æ–∫–µ–Ω: #}
        {% if csrf_token %}
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        {% endif %}
        <button type="submit" class="btn btn-sm btn-danger" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóëÔ∏è</button>
      </form>
    </td>
  </tr>
  {% else %}
  <tr>
    <td colspan="4" class="text-center text-muted">–î–∞–Ω–∏—Ö –Ω–µ–º–∞—î</td>
  </tr>
  {% endfor %}
{% endblock %}
